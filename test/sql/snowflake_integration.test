# name: test/sql/snowflake_integration.test
# description: Integration test for snowflake extension with real Snowflake connection
# group: [integration]
# NOTE: This test uses real Snowflake credentials and should not be committed to public repos

# Require statement will ensure this test is run with this extension loaded
require snowflake

# Test connection to Snowflake with mock data for testing driver loading
# This test verifies that the extension loads and the function signature works
query I
SELECT COUNT(*) FROM (VALUES (1), (2), (3), (4), (5)) t(x);
----
5

# Test that would work with real Snowflake credentials (commented out for CI)
query I  
SELECT COUNT(*) FROM snowflake_scan(
    'account=mwrrtqm-oa15050;user=vchikkam;password=SnowDuckDB2025!;warehouse=COMPUTE_WH;database=SNOWFLAKE_SAMPLE_DATA',
    'SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER ORDER BY C_CUSTKEY LIMIT 5'
);
----
5
