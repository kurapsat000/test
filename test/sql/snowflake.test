# name: test/sql/snowflake.test
# description: test snowflake extension
# group: [sql]

# Before we load the extension, this will fail
statement error
SELECT snowflake_version();
----
Catalog Error: Scalar Function with name snowflake_version does not exist!

# Require statement will ensure this test is run with this extension loaded
require snowflake

# Confirm the extension works
query I
SELECT snowflake_version();
----
Snowflake Extension v0.1.0

# Test that snowflake_scan exists and validates parameters
statement error
SELECT * FROM snowflake_scan('');
----
No function matches the given name and argument types 'snowflake_scan(VARCHAR)'

# Test invalid connection string
statement error  
SELECT * FROM snowflake_scan('invalid', 'SELECT 1');
----
Failed to bind snowflake_scan: {"exception_type":"Invalid Input","exception_message":"Snowflake connection string missing required 'account' parameter"}

# More comprehensive tests would require actual Snowflake credentials
# These would be added in a separate test file that's not committed to the repository