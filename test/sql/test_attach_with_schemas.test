# name: test/sql/test_attach_with_schemas.test
# description: Test attach function that should use ListSchemas
# group: [sql]

require snowflake

require-env SNOWFLAKE_TEST_ACCOUNT

# For now, this test shows the current behavior (no schema qualification)
statement ok
CREATE OR REPLACE VARIABLE sf_conn VARCHAR = 
    'account=' || '${SNOWFLAKE_TEST_ACCOUNT}' || 
    ';user=' || '${SNOWFLAKE_TEST_USER}' || 
    ';password=' || '${SNOWFLAKE_TEST_PASSWORD}' || 
    ';warehouse=' || '${SNOWFLAKE_TEST_WAREHOUSE}' || 
    ';database=' || '${SNOWFLAKE_TEST_DATABASE}';

# Current behavior: Lists all tables without schema info
query I
SELECT snowflake_attach(getvariable(sf_conn));
----
true

# This would be better with schema-qualified views:
# CREATE VIEW "PUBLIC.CUSTOMER" AS ...
# CREATE VIEW "INFORMATION_SCHEMA.TABLES" AS ...
# etc.